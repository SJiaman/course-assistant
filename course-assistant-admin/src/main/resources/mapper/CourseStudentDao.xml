<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zrn.assistant.dao.CourseStudentDao">

    <resultMap type="com.zrn.assistant.entity.CourseStudentEntity" id="courseStudentMap">
        <result property="id" column="id"/>
        <result property="studentId" column="student_id"/>
        <result property="courseId" column="course_id"/>
        <result property="createTime" column="create_time"/>
        <result property="modifyTime" column="modify_time"/>
        <result property="deleted" column="deleted"/>
    </resultMap>

    <select id="getTeacherStudent"  resultType="com.zrn.assistant.dto.CourseStudentDTO">
        select
            b.id,
            b.student_id,
            c.username,
            c.real_name,
            c.college,
            c.class_name,
            a.`name` as courseName
        from
            t_course a join
            t_course_student b on a.id = b.course_id
                       join t_user c on b.student_id = c.id
        <!-- 如果QueryWrapper存在的话，就拼where条件，因为QueryWrapper其实就是在封装where条件 where b.deleted = 0 and a.teacher_id = #{id};-->
        <if test="ew.emptyOfWhere == false">
            ${ew.customSqlSegment}
        </if>

    </select>


    <select id="getStudentByCourseName"  resultType="com.zrn.assistant.dto.CourseStudentDTO" parameterType="string">
        select
            b.id,
            b.student_id,
            c.username,
            c.real_name,
            c.college,
            c.class_name,
            a.`name` as courseName
        from
            t_course a join
            t_course_student b on a.id = b.course_id
                       join t_user c on b.student_id = c.id
        where b.deleted = 0
        <if test="courseName != null and courseName != ''">
            and a.`name` =#{courseName}
        </if>
    </select>

</mapper>